{% extends "@ChamiloTheme/Layout/layout_one_col.html.twig" %}

{% block content %}
  {% if is_granted('EDIT', course) %}
    <div class="actions">
      <a class="btn btn-secondary"
         href="{{ url('chamilo_core_resource_new_folder', {'tool': tool, 'type': type, 'cidReq': course.code, 'id_session': sessionObj.id, 'id': id }) }}">
        {{ 'New folder' | trans }}
      </a>
      <a class="btn btn-secondary"
         href="{{ url('chamilo_core_resource_new', { 'tool': tool, 'type': type, 'cidReq': course.code, 'id_session': sessionObj.id,  'id': id }) }}">
        {{ 'Create new document' | trans }}
      </a>
      <a class="btn btn-secondary"
         href="{{ url('chamilo_core_resource_upload', { 'tool': tool, 'type': type, 'cidReq': course.code, 'id_session': sessionObj.id,  'id': id }) }}">
        {{ 'Upload' | trans }}
      </a>
    </div>
  {% endif %}

    <style>
        .fancybox-slide--iframe .fancybox-content {
            width  : 800px;
            height : 600px;
            max-width  : 80%;
            max-height : 80%;
            margin: 0;
        }
    </style>

    <script>
        $(function () {
            $('[data-fancybox="gallery"]').fancybox({
                toolbar: "true",
                buttons: [
                    "zoom",
                    //"share",
                    "slideShow",
                    //"fullScreen",
                    "download",
                    "thumbs",
                    "close"
                ],
                // https://github.com/fancyapps/fancybox/issues/2009
                video: {
                    autoStart: false
                },
                // Base template for layout
                {#baseTpl:#}
                {#    '<div class="fancybox-container" role="dialog" tabindex="-1">' +#}
                {#    '<div class="fancybox-bg"></div>' +#}
                {#    '<div class="fancybox-inner">' +#}
                {#    '<div class="fancybox-infobar"><span data-fancybox-index></span>&nbsp;/&nbsp;<span data-fancybox-count></span></div>' +#}
                {#    '<div class="fancybox-toolbar">{{buttons}}</div>' +#}
                {#    '<div class="fancybox-navigation">{{arrows}}</div>' +#}
                {#    '<div class="fancybox-stage"></div>' +#}
                {#    '<div class="fancybox-caption"><div class=""fancybox-caption__body"></div></div>' +#}
                {#    '</div>' +#}
                {#'</div>',#}
            });

            $('.change_visibility').on('click', function (e) {
                e.preventDefault();
                var link = $(this);
                var url = $(this).attr('href');
                console.log(url);
                $.ajax({
                    type: "post",
                    url: url,
                    contentType: "html",
                    beforeSend: function(){
                        link.find('i').addClass('fa-spinner fa-spin');
                        link.find('i').removeClass('fa-eye');
                        link.find('i').removeClass('fa-eye-slash');
                    },
                    success: function (response) {
                        link.find('i').removeClass('fa-eye');
                        link.find('i').removeClass('fa-eye-slash');
                        link.find('i').removeClass('fa-spinner fa-spin');
                        link.find('i').addClass(response.icon);
                    },
                });
            });
        });
    </script>

  {% include '@ChamiloTheme/Resource/grid.html.twig' %}
{% endblock %}
